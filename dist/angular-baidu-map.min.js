!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("angular"));else if("function"==typeof define&&define.amd)define(["angular"],n);else{var t="object"==typeof exports?n(require("angular")):n(e.angular);for(var o in t)("object"==typeof exports?exports:e)[o]=t[o]}}(window,function(e){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(n,t){n.exports=e},function(e,n,t){"use strict";t.r(n);var o={};t.d(o,"map",function(){return a}),t.d(o,"offline",function(){return l}),t.d(o,"offlineLabel",function(){return u});var r=t(0),i=t.n(r),a={width:"100%",height:"100%",display:"none"},l={width:"100%",height:"100%",backgroundColor:"#E6E6E6",position:"relative",display:"none"},u={fontSize:"30px",margin:0,position:"absolute",top:"50%",left:"50%","margin-right":"-50%",transform:"translate(-50%, -50%)"};function c(e,n){if(s(e))throw new Error(n)}function s(e){return null===e||void 0===e}var p=["navigation","overviewmap","scale","maptype","copyright","geolocation","panorama"];var d=["heatmap"];var f={longitude:121.506191,latitude:31.245554},m=10;function y(e,n){s(n)||s(n.disableDragging)||e[(n.disableDragging?"disable":"enable")+"Dragging"](),s(n)||s(n.enableScrollWheelZoom)||e[(n.enableScrollWheelZoom?"enable":"disable")+"ScrollWheelZoom"](),s(n)||s(n.disableDoubleClickZoom)||e[(n.disableDoubleClickZoom?"disable":"enable")+"DoubleClickZoom"](),s(n)||s(n.enableKeyboard)||e[(n.enableKeyboard?"enable":"disable")+"Keyboard"](),s(n)||s(n.enableInertialDragging)||e[(n.enableInertialDragging?"enable":"disable")+"InertialDragging"](),s(n)||s(n.enableContinuousZoom)||e[(n.enableContinuousZoom?"enable":"disable")+"ContinuousZoom"](),s(n)||s(n.disablePinchToZoom)||e[(n.disablePinchToZoom?"disable":"enable")+"PinchToZoom"](),!s(n)&&!s(n.cursor)&&e.setDefaultCursor(n.cursor),!s(n)&&!s(n.draggingCursor)&&e.setDraggingCursor(n.draggingCursor),!s(n)&&!s(n.currentCity)&&e.setCurrentCity(n.currentCity),!s(n)&&!s(n.centerAndZoom)&&e.centerAndZoom(new BMap.Point(n.centerAndZoom.longitude||f.longitude,n.centerAndZoom.latitude||f.latitude),n.centerAndZoom.zoom||m)}var h=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var v={bindings:{offlineTxt:"<",mapOptions:"<",loaded:"&",click:"&"},transclude:!0,template:'\n        <div ng-style="$ctrl.style.map" class="baidu-map-instance"></div>\n        <div ng-style="$ctrl.style.offline" class="baidu-map-offline">\n            <label ng-style="$ctrl.style.offlineLabel">{{ $ctrl.offlineTxt || \'NO_NETWORK\' }}</label>\n        </div>\n        <div ng-transclude style="display: none"></div>\n    ',controller:function(){function e(n,t,r,i){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=n,this.$element=t,this.$attrs=r,this.style=o,this.mapScriptService=i}return e.$inject=["$scope","$element","$attrs","mapScriptService"],h(e,[{key:"$onInit",value:function(){var e=this;this.mapReady=this.mapScriptService.load().then(function(){return n=e.$element.children()[0],t=e.mapOptions,y(o=new BMap.Map(n,t),t),o;var n,t,o}).then(function(n){return e.loaded({map:n}),e.$scope.$apply(),e.map=n}).then(function(){if(e.$attrs.click){var n=e.clickListener=function(n){e.click({e:n}),e.$scope.$apply()};e.map.addEventListener("click",n)}})}},{key:"$onChanges",value:function(e){this.map&&y(this.map,e.mapOptions.currentValue)}},{key:"$onDestroy",value:function(){this.map.removeEventListener("click",this.clickListener)}},{key:"addOverlay",value:function(e){return w(this.map,"addOverlay",e)}},{key:"removeOverlay",value:function(e){return w(this.map,"removeOverlay",e)}},{key:"addControl",value:function(e){return w(this.map,"addControl",e)}},{key:"removeControl",value:function(e){return w(this.map,"removeControl",e)}},{key:"getMap",value:function(){return this.map}}]),e}()};function w(e,n){for(var t=arguments.length,o=Array(t>2?t-2:0),r=2;r<t;r++)o[r-2]=arguments[r];return new Promise(function(t){e[n].apply(e,o),t()})}function b(e,n){var t={url:e.url};return c(e.url,"url is required in "+n),c(e.size,"size is required in "+n),t.size=A(e.size,n+".size"),new BMap.Icon(t.url,t.size)}function A(e,n){return c(e.width,"width is required in "+n),c(e.height,"height is required in "+n),new BMap.Size(e.width,e.height)}function O(e,n){return c(e.longitude,"longitude is required in "+n),c(e.latitude,"latitude is required in "+n),new BMap.Point(e.longitude,e.latitude)}var _=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var g={bindings:{point:"<",options:"<",click:"&"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(n,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=n,this.$attrs=t}return e.$inject=["$scope","$attrs"],_(e,[{key:"$onInit",value:function(){var e=this;c(this.point,"point is required for <marker>"),this.mapCtrl.mapReady.then(function(){var n=O(e.point,"<marker> point"),t=function(e){var n=JSON.parse(JSON.stringify(e||{}));n.offset&&(n.offset=A(n.offset,"<marker> options.offset"));n.icon&&(n.icon=b(n.icon,"<marker> options.icon"));n.shadow&&(n.shadow=b(n.shadow,"<marker> options.shadow"));return n}(e.options),o=e.marker=new BMap.Marker(n,t);return e.mapCtrl.addOverlay(o),o}).then(function(n){e.$attrs.click&&(e.clickHandler=function(t){e.click({e:t,marker:n,map:e.mapCtrl.getMap()}),e.$scope.$apply()},n.addEventListener("click",e.clickHandler))})}},{key:"$onChanges",value:function(e){this.marker&&e.point&&e.point.currentValue&&this.marker.setPosition(O(e.point.currentValue,"<marker> point"))}},{key:"$onDestroy",value:function(){this.marker.removeEventListener("click",this.clickHandler),this.mapCtrl.removeOverlay(this.marker)}}]),e}()};var M=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var P={bindings:{type:"@",options:"<"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return M(e,[{key:"$onInit",value:function(){var e=this;!function(e){if(p.indexOf((e||"").toLowerCase())<0)throw new Error("control type should be one of: ["+p.join(",")+"]")}(this.type),this.mapCtrl.mapReady.then(function(){return function(e,n){if("navigation"===e)return new BMap.NavigationControl(n);if("overviewmap"===e)return new BMap.OverviewMapControl(n);if("scale"===e)return new BMap.ScaleControl(n);if("maptype"===e)return new BMap.MapTypeControl(n);if("copyright"===e){var t=new BMap.CopyrightControl(n);return o=n.copyrights,"[object Array]"===Object.prototype.toString.call(o)&&n.copyrights.forEach(function(e){t.addCopyright(e)}),t}var o;if("geolocation"===e)return new BMap.GeolocationControl(n);if("panorama"===e)return new BMap.PanoramaControl(n)}(e.type.toLowerCase(),e.options)}).then(function(n){return e.mapCtrl.addControl(n),e.control=n,n})}},{key:"$onDestroy",value:function(){this.mapCtrl.removeControl(this.control)}}]),e}()};var C=function(){var e=window.loadHeatMapPromise;return e||(window.loadHeatMapPromise=function e(n){return new Promise(function(t,o){var r=document.createElement("script");r.type="text/javascript",r.src=n,r.onerror=function(){document.body.removeChild(r),setTimeout(function(){e(n)},3e4)},r.onload=t,document.body.appendChild(r)})}("//api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"))};var T=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var k={bindings:{type:"@",options:"<",dataset:"<"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return T(e,[{key:"$onInit",value:function(){var e=this;!function(e){if(d.indexOf((e||"").toLowerCase())<0)throw new Error("overlay type should be one of: ["+d.join(",")+"]")}(this.type),this.realType=this.type.toLowerCase(),this.mapCtrl.mapReady.then(function(){return function(e,n){if("heatmap"===e)return function(e){return C().then(function(){return new BMapLib.HeatmapOverlay(e)})}(n)}(e.realType,e.options)}).then(function(n){return e.mapCtrl.addOverlay(n),e.overlay=n,N(e.realType,e.overlay,e.dataset),n})}},{key:"$onChanges",value:function(e){e.dataset&&e.dataset.currentValue&&N(this.realType,this.overlay,e.dataset.currentValue)}},{key:"$onDestroy",value:function(){this.mapCtrl.removeOverlay(this.overlay)}}]),e}()};function N(e,n,t){"heatmap"===e&&t&&n.setDataSet(t)}function I(){return Array.prototype.slice.call(document.querySelectorAll("baidu-map")).forEach(function(e){e.querySelector(".baidu-map-offline")&&e.removeChild(e.querySelector(".baidu-map-offline")),e.querySelector(".baidu-map-instance").style.display="block"})}t.d(n,"ngBaiduMap",function(){return B}),window.BMAP_ANCHOR_TOP_LEFT=0,window.BMAP_ANCHOR_TOP_RIGHT=1,window.BMAP_ANCHOR_BOTTOM_LEFT=2,window.BMAP_ANCHOR_BOTTOM_RIGHT=3,window.BMAP_NAVIGATION_CONTROL_LARGE=0,window.BMAP_NAVIGATION_CONTROL_SMALL=1,window.BMAP_NAVIGATION_CONTROL_PAN=2,window.BMAP_NAVIGATION_CONTROL_ZOOM=3,window.BMAP_UNIT_METRIC="metric",window.BMAP_UNIT_IMPERIAL="us",window.BMAP_MAPTYPE_CONTROL_HORIZONTAL=0,window.BMAP_MAPTYPE_CONTROL_DROPDOWN=1,window.BMAP_MAPTYPE_CONTROL_MAP=2,window.BMAP_ANIMATION_DROP=1,window.BMAP_ANIMATION_BOUNCE=2,window.BMAP_POINT_SIZE_TINY=1,window.BMAP_POINT_SIZE_SMALLER=2,window.BMAP_POINT_SIZE_SMALL=3,window.BMAP_POINT_SIZE_NORMAL=4,window.BMAP_POINT_SIZE_BIG=5,window.BMAP_POINT_SIZE_BIGGER=6,window.BMAP_POINT_SIZE_HUGE=7,window.BMAP_PANORAMA_INDOOR_SCENE="inter",window.BMAP_PANORAMA_STREET_SCENE="street",window.BMAP_PANORAMA_POI_HOTEL="hotel",window.BMAP_PANORAMA_POI_CATERING="catering",window.BMAP_PANORAMA_POI_MOVIE="movie",window.BMAP_PANORAMA_POI_TRANSIT="transit",window.BMAP_PANORAMA_POI_INDOOR_SCENE="indoor_scene",window.BMAP_PANORAMA_POI_NONE="none";i.a.module("baiduMap",[]).provider("mapScriptService",function(){var e=null,n=void 0;this.setKey=function(t){n="//api.map.baidu.com/api?v=2.0&ak="+(e=t)+"&callback=baidumapinit",n=location.protocol.indexOf("http")>-1?n+"&s="+("https:"===location.protocol?1:0):"https:"+n+"&s=1"},this.$get=["$rootScope",function(t){"ngInject";return{load:function(){c(e,"ak should be set before use. Read: https://leftstick.github.io/BaiduMapForAngularJS/#!/quickstart");var o=t.loadBaiduMapPromise;return o?o.then(I):t.loadBaiduMapPromise=new Promise(function(e,t){window.baidumapinit=e,function e(n){var t=document.createElement("script");t.type="text/javascript",t.src=n,t.onerror=function(){Array.prototype.slice.call(document.querySelectorAll("baidu-map .baidu-map-offline")).forEach(function(e){e.style.display="block"}),document.body.removeChild(t),setTimeout(function(){e(n)},3e4)},document.body.appendChild(t)}(n)}).then(I)}}}]}).component("baiduMap",v).component("marker",g).component("control",P).component("overlay",k);var B="baiduMap"}])});